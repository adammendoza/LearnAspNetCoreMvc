@model IEnumerable<ExploreCalifornia.Models.Post>

<h1>Explorer's Blog</h1>

<p>
    Below are a few of the latest posts from some of our explorers.
</p>

<p class="pager">
    @if (ViewBag.HasPreviousPage)
    {
        <a class="prev" href="@Url.Action("Index", "Blog", new { page = ViewBag.PreviousPage })">
            &lt; Previous
        </a>
    }

    @if (ViewBag.HasNextPage)
    {
        <a class="next" href="@Url.Action("Index", "Blog", new { page = ViewBag.NextPage })">
            Next &gt;
        </a>
    }
</p>

<div class="blog-posts">
    @foreach (var post in Model)
    {
        @Html.Partial("_Post", post)
    }
</div>

<script>
    function load(url, el) {
        var req = new XMLHttpRequest();
        req.addEventListener("load", function () {
            el.innerHTML = this.responseText;
        });
        req.open("GET", url);
        req.setRequestHeader("X-Requested-With", "XMLHttpRequest");
        req.send();
    }

    function initializePaging() {
        var blogPostsEl = document.getElementById('mainContent');
        var pagerButtons = document.querySelectorAll('.pager a');

        pagerButtons.forEach(function () {
            this.addEventListener('click', function (event) {
                event.preventDefault();
                load(event.target.href, blogPostsEl);
                return false;
            });
        })
    }

    window.onload = initializePaging;
</script>